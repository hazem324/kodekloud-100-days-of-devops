# Ansible 4.8.0 — Jump Host (Control Node) Installation Guide

Purpose
- Install Ansible v4.8.0 on the jump host using pip3 only.
- Make the Ansible CLI available system-wide so all users can run Ansible commands from any shell.

Prerequisites
- A jump host running a dnf-based Linux distribution (Fedora / RHEL / CentOS / Rocky / Alma).
- A user with sudo privileges.
- Network access to PyPI (or a configured PyPI mirror) to download packages.

Quick summary (commands)
1. Update system packages
2. Install Python 3 and pip3 (and build deps if needed)
3. Remove conflicting / OS-installed Ansible packages (if present)
4. Install Ansible 4.8.0 with pip3 system-wide
5. Verify installation

Step-by-step instructions

1) Update system packages
```bash
sudo dnf update -y
```

2) Install Python 3 and pip3 (plus common build dependencies)
- Some Python packages (e.g., cryptography) may require development tools.
```bash
sudo dnf install -y python3 python3-pip
# If pip install fails while building wheels, also install build deps:
sudo dnf install -y gcc python3-devel libffi-devel openssl-devel redhat-rpm-config
```

3) Remove existing Ansible packages to avoid conflicts
- Remove OS packages and any pip-installed older versions:
```bash
# Remove dnf-installed ansible if present
sudo dnf remove -y ansible

# Remove pip-installed ansible packages (if any)
sudo pip3 uninstall -y ansible ansible-base
```

4) (Optional but recommended) Upgrade pip tooling
```bash
sudo pip3 install --upgrade pip setuptools wheel
```

5) Install Ansible 4.8.0 system-wide using pip3
```bash
sudo pip3 install ansible==4.8.0
```
- This installs the bundled `ansible` package (which contains ansible-core + collections appropriate for that release).
- System-wide (sudo) install places executables typically under `/usr/local/bin` (check `which ansible` after install).

6) Make sure the Ansible binary is globally accessible
- Most systems include `/usr/local/bin` in PATH for all users. Verify:
```bash
which ansible
# Example output: /usr/local/bin/ansible
```
- If `which ansible` returns a path not in non-login shells or some users do not see it, you can create a symlink to `/usr/bin`:
```bash
sudo ln -s "$(which ansible)" /usr/bin/ansible
# and for related binaries:
for b in ansible-playbook ansible-inventory ansible-galaxy ansible-doc ansible-console; do
  [ -f "/usr/local/bin/$b" ] && sudo ln -sf "/usr/local/bin/$b" "/usr/bin/$b"
done
```
- Only create symlinks if necessary and approved by your OS policy.

Verification
- Check the installed Ansible version and core engine:
```bash
ansible --version
# Expected for ansible 4.8.0:
# ansible [core 2.11.12]
#   configured module search path = ...
```
- Show pip package details:
```bash
pip3 show ansible
```
- Confirm `ansible` binary location:
```bash
which ansible
```

Notes about versions
- `ansible==4.8.0` bundles `ansible-core` version 2.11.12 (you will see ansible-core version reported by `ansible --version`).
- If you need to pin other dependencies, consider using a requirements file for pip.

Common troubleshooting
- Permission / write errors during pip install:
  - Ensure you used `sudo pip3 install ...` for system-wide installs.
  - Alternatively use a system package manager or a controlled site-packages directory if your environment disallows pip system installs.
- Build errors when compiling wheels (error messages referencing `gcc`, `openssl`, `ffi`):
  - Install build dependencies: `sudo dnf install -y gcc python3-devel libffi-devel openssl-devel redhat-rpm-config`
- Conflicting OS-managed Ansible package:
  - Remove with `sudo dnf remove -y ansible` before using pip to install.
- Ansible not in PATH for non-login shells:
  - Verify `/usr/local/bin` exists in `/etc/profile`, `/etc/skel/.bashrc`, or system-wide shell config; if not, consider symlink to `/usr/bin` as shown above.

Uninstalling / Reverting
- To remove the pip-installed version:
```bash
sudo pip3 uninstall -y ansible ansible-base
```
- To reinstall via dnf (if desired):
```bash
sudo dnf install -y ansible
```

Security and maintenance recommendations
- Prefer pinned versions for reproducibility (we used `ansible==4.8.0`).
- Periodically check for security advisories related to Ansible and Python packages.
- Consider using a dedicated VM/container or virtualenv for control node if you want isolation from system Python.
- Avoid mixing OS packages and pip installs for the same package — choose one manager to prevent file conflicts.

Example: Full command sequence (copy & paste)
```bash
sudo dnf update -y
sudo dnf install -y python3 python3-pip
sudo dnf remove -y ansible
sudo pip3 uninstall -y ansible ansible-base || true
sudo pip3 install --upgrade pip setuptools wheel
sudo pip3 install ansible==4.8.0
ansible --version
pip3 show ansible
which ansible
```

References
- Ansible project: https://docs.ansible.com/
- Ansible release notes (for version details): https://docs.ansible.com/ansible/latest/collections/index.html
- Python packaging guidance: https://packaging.python.org/

Appendix: Example minimal inventory + test
- Create an inventory file (example `/etc/ansible/hosts` or `~/inventory`):
```ini
[test-hosts]
server1.example.com ansible_user=ec2-user
```
- Test connectivity (using SSH and a single module):
```bash
ansible -i ~/inventory all -m ping
```

If you want, I can also:
- Produce a shell script that runs the full install sequence.
- Create a systemd service or profile changes to ensure PATH consistency across all users.
- Provide an Ansible playbook to bootstrap the control node itself.