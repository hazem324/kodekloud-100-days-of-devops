```markdown
# Create a BASH Script for News Website Backup

The production support team of xFusionCorp Industries is working on developing some bash scripts to automate different day to day tasks. One is to create a bash script for taking websites backup. They have a static website running on **App Server 1** (`stapp01.stratos.xfusioncorp.com`) in Stratos Datacenter, and they need to create a bash script named **news_backup.sh** which should accomplish the following tasks. (Also remember to place the script under `/scripts` directory on App Server 1).

- Create a zip archive named `xfusioncorp_news.zip` of `/var/www/html/news` directory.
- Save the archive in `/backup/` on App Server 1. This is a temporary storage, as backups from this location will be cleaned on a weekly basis. Therefore, we also need to save this backup archive on Nautilus Backup Server.
- Copy the created archive to Nautilus Backup Server (`stbkp01.stratos.xfusioncorp.com`) in `/backup/` location as user `clint`.
- Please make sure the script won't ask for a password while copying the archive file. Additionally, the respective server user (**tony** on App Server 1) must be able to run it.

## Steps

1. Login to App Server 1 (`stapp01`) as `tony` and switch to sudo where required.

2. Install required tools if missing:
   ```bash
   sudo yum install nano zip -y
   ```
   *(nano for editing, zip for compression; unzip is installed as dependency)*

3. Generate SSH key pair for passwordless authentication:
   ```bash
   ssh-keygen -t rsa -b 2048
   ```
   *(Press enter for defaults and no passphrase)*

4. Copy the public key to the backup server:
   ```bash
   ssh-copy-id clint@stbkp01.stratos.xfusioncorp.com
   ```
   *(Provide clint's password when prompted)*

5. Create the script `/scripts/news_backup.sh` using nano:
   ```bash
   sudo mkdir -p /scripts  # if directory doesn't exist
   sudo nano /scripts/news_backup.sh
   ```

   Add the following content:
   ```bash
 #!/bin/bash

# Variables
SOURCE_DIR="/var/www/html/beta"
BACKUP_DIR="/backup"
ARCHIVE_NAME="xfusioncorp_beta.zip"
REMOTE_USER="nautilus"
REMOTE_HOST="nautilus.backup.server"
REMOTE_DIR="/backup"

# Create zip archive
zip -r "${BACKUP_DIR}/${ARCHIVE_NAME}" "${SOURCE_DIR}"

# Copy archive to Nautilus Backup Server
scp "${BACKUP_DIR}/${ARCHIVE_NAME}" "${REMOTE_USER}@${REMOTE_HOST}:${REMOTE_DIR}"

   ```

6. Give execute permission:
   ```bash
   sudo chmod 755 /scripts/news_backup.sh
   ```

7. Test the script:
   ```bash
   /scripts/news_backup.sh
   ```

   It should create the zip locally and copy it to the backup server without prompting for a password.

## Good to Know?

### Bash Scripting Best Practices
- **Shebang**: Always start with `#!/bin/bash` or `#!/bin/sh`
- **Error Handling**: Use `set -e` to exit on errors
- **Variables**: Quote variables: `"$variable"` to prevent word splitting
- **Functions**: Break complex logic into reusable functions

### Backup Strategies
- **Full Backup**: Complete copy of all data
- **Incremental**: Only changed files since last backup
- **Differential**: Changed files since last full backup
- **Compression**: Use zip, tar.gz to save space

### Archive Commands
- **zip**: `zip -r archive.zip directory/` (cross-platform)
- **tar**: `tar -czf archive.tar.gz directory/` (Unix standard)
- **Exclusions**: Skip temporary files and logs
- **Verification**: Test archives before relying on them

### Remote Copy Methods
- **scp**: Secure copy over SSH
- **rsync**: Efficient synchronization tool
- **sftp**: Interactive file transfer
- **Authentication**: Use SSH keys for automation
```