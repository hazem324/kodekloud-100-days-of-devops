Perfect ðŸ‘Œ Iâ€™ll generate a clean **README.md** for this task using the same structure style you shared â€” clear steps, commands, explanation, and troubleshooting notes.

You can copy-paste this directly into your repository.

---

# Resolve Volume Mount Mismatch â€“ Nginx & PHP-FPM (Kubernetes)

We encountered an issue with our **Nginx + PHP-FPM multi-container Pod** where the website stopped working.

After investigation, the root cause was a **volume mount path mismatch** between containers and the nginx configuration.

This document explains how the issue was identified and fixed.

---

## ðŸŽ¯ Problem Summary

* Pod name: `nginx-phpfpm`
* ConfigMap name: `nginx-config`
* Shared volume: `emptyDir`
* Issue: Containers were mounting the shared volume at different paths.
* Result: Nginx and PHP-FPM were not accessing the same document root.

---

## ðŸ” Investigation

### 1ï¸âƒ£ Check Pod Details

```bash
kubectl get pod nginx-phpfpm
kubectl describe pod nginx-phpfpm
```

### 2ï¸âƒ£ Export Pod YAML

```bash
kubectl get pod nginx-phpfpm -o yaml > nginx-phpfpm.yml
```

### 3ï¸âƒ£ Check ConfigMap

```bash
kubectl get configmap nginx-config -o yaml
```

Inside `nginx.conf`, we found:

```nginx
root /var/www/html;
```

This confirms the nginx document root is:

```
/var/www/html
```

---

## ðŸš¨ Root Cause

The shared volume `shared-files` was mounted at:

* `/var/www/html` in one container
* `/usr/share/nginx/html` in the other container

Because of this mismatch:

* Nginx served from `/var/www/html`
* PHP-FPM executed from `/usr/share/nginx/html`
* Files were not aligned
* Website failed

---

## âœ… Solution

Both containers must mount the shared volume at the **same path**, matching the nginx root:

```
/var/www/html
```

---

## ðŸ›  Fix Steps

### Step 1: Edit Pod YAML

```bash
vi nginx-phpfpm.yml
```

Ensure both containers use:

```yaml
containers:
- image: php:7.2-fpm-alpine
  name: php-fpm-container
  volumeMounts:
  - mountPath: /var/www/html
    name: shared-files

- image: nginx:latest
  name: nginx-container
  volumeMounts:
  - mountPath: /var/www/html
    name: shared-files
  - mountPath: /etc/nginx/nginx.conf
    name: nginx-config-volume
    subPath: nginx.conf
```

> âš  Important: `subPath: nginx.conf` must be present.

---

### Step 2: Recreate the Pod

Volume mounts are immutable, so we must delete and recreate:

```bash
kubectl delete pod nginx-phpfpm
kubectl apply -f nginx-phpfpm.yml
```

Verify:

```bash
kubectl get pods
```

Status should be:

```
2/2 Running
```

---

### Step 3: Copy Application File

Copy `index.php` into nginx document root:

```bash
kubectl cp /home/thor/index.php nginx-phpfpm:/var/www/html/index.php -c nginx-container
```

---

### Step 4: Test

Option 1:

```bash
curl localhost:8080
```
